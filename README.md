# summarize-credit-card-per-years
## 概要
クレジットカード明細の年単位の集計値を折れ線グラフ等で解析するための表を作成します。  
## 実行方法
function `getAnnualAggregate`を実行すると、指定されたシートにクレジットカード明細の集計結果を出力します。  
D列にグラフ出力用項目を出力します。合計金額を降順でソートし、１１位以下の項目は全て「その他」として集約するよう、項目名を設定します。  
E列にグラフ出力用項目を出力します。AWSとそれ以外で集約するよう、項目名を設定します。  
function `createPivotTable`を実行すると、左から二番目のシートに集計結果を集約したピボットテーブルを出力します。  
## 事前作業
スクリプトプロパティの設定をしてください。
- `awsName` 最新のクレジットカード明細でのAWSの項目名を設定してください。  
- `datasourceSheetIndex` 出力スプレッドシートのどのシートに集計結果を出力するか、数値で指定してください。一番左のシートは0になります。  
- `outputSheetUrl` 出力スプレッドシートのURLを設定してください。  例：https://docs.google.com/spreadsheets/d/.../edit#gid=0 
- `targetDriveId` 入力スプレッドシートが格納されているドライブのIDを設定してください。  ※ URL：https://drive.google.com/drive/folders/...の...の文字列です。
## 制限事項
- ファイル名等が下記の仕様に沿っている必要があります。
    - 入力スプレッドシートの名前の最初4文字が年度（4桁の半角数字）である。  
    - 'List'という名称のシートのA列に項目名、一行目が「計」という文字列の列が項目毎の金額合計、一列目が「計」という文字列の行が月毎の金額合計である。
    - 出力用スプレッドシートのシート数が２以上存在している。
